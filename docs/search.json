[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Supplemental materials (Version 1.0) Breast, Colorectal, and Pancreatic Cancer Mortality With Pathogenic Variants in ATM, CHEK2, or PALB2",
    "section": "",
    "text": "Supplemental information on data and complete model outputs as well as all R and Stata code used for the analyses presented in the paper published 2025 in the Journal of Clinical Oncology DOI https://doi.org/10.1200/JCO-24-02442"
  },
  {
    "objectID": "index.html#kurian-a-et.al.",
    "href": "index.html#kurian-a-et.al.",
    "title": "Association of Germline Pathogenic Variants in ATM, CHEK2 and PALB2 with Mortality from Breast, Colorectal, or Pancreatic Cancer",
    "section": "",
    "text": "Supplemental information on data and complete model outputs as well as all R and Stata code used in the analyses presented in the paper"
  },
  {
    "objectID": "final_round.html",
    "href": "final_round.html",
    "title": "Main Analyses",
    "section": "",
    "text": "Re-running frailty models currently set to off\nLast run October 25, 2024 at 2:54PM-3:00PM (check modified date saved results)"
  },
  {
    "objectID": "final_round.html#model-strat",
    "href": "final_round.html#model-strat",
    "title": "Main Analyses",
    "section": "Overview of modeling strategy",
    "text": "Overview of modeling strategy\nWe used directed acyclic graphs to justify the selection of variables for the analysis.(Pearl 1995; Lipsky and Greenland 2022)\nThe primary predictor of interest is the gene group describing the presence or absence of specific pathogenic variants. The outcome is mortality. In addition the following variable groups were included:\nCovariate list\n\n\n\n\n\n\n\n\n\n\nClinical\nTreatment\nShared ancestry\nAccess and quality\nSelection into cohort\n\n\n\n\nAge at diagnosis\nChemotherapy\nRace\nPoverty ( county level)\nGenetic testing\n\n\nStage\nSurgery\n\nRurality (county level)\n\n\n\nGrade (cancer-specific)\nRadiation\n\nState\n\n\n\nRectal vs colon (cancer-specific)\nReceipt of HER2-therapy (cancer-specific)\n\n\n\n\n\n\nAs only people from the SEER registry who had genetic testing within 6 months of diagnosis were included, all of the results are conditioned on receipt of genetic testing even though this variable is not formally included in our analysis.\n\n\n\n\n\n\nVariable selection - rationale (click to view)\n\n\n\n\n\nThe goal of the analysis is to describe whether people who have one of several pathogenic variants (PVs) or gene groups would be predicted to have a different mortality hazard in comparison to the average hazard of people with the cancer. More specifically, for a person who has been diagnosed and is planning or undergoing treatment with a cancer of known stage and grade and then finds out that they have a PV, the pertinent question becomes whether this finding will have any implications for their mortality risk beyond what they already know about their diagnosis.\nWe could expect that the presence of a PV can potentially modify the age at which one gets cancer, the stage or grade at which it occurs and the treatment that is received. These clinical and treatment variables are then mediators between the presence of a PV and mortality as represented in the DAG below. However, given that a patient already knows that information, to answer the question described requires trying to estimate any direct effect of PV on mortality independent of any paths through the described mediators and any possible confounders of the relationship.\n\n\ncode\nlibrary(dagitty)\nlibrary(ggdag)\nrisk&lt;-dagify(\n  Y ~ PV + C + M + C2, PV ~ C, M ~ PV + C2, \n  coords =list(\n    x=c(Y=7,C=3, PV=0, M =3 ,C2 = 7 ), \n    y=c(Y=0,C=-3,PV=0, M = 3, C2 = 3  )\n    ),\n  exposure=\"PV\",\n  outcome=\"Y\",\n  labels=c(PV=\"PV\", C= \"PV-outcome \\n Confounder\" , Y=\" Mortality\", M = \"Clinical/treatment Mediator\",\n           C2=\"Mediator-outcome \\n confounder\")\n) \nmyplot(risk)\n\n\n\n\n\n\n\n\n\nWe wish to block all the clinical/treatment mediators as well as any confounders of the PV - mortality relationship in order to test for whether there is any direct effect of PV on mortality. Unfortunately, once we adjust for the mediators we need to also account for any mediator - outcome and any PV - mediator confounders as well. If we do not then the correlations in that pathway will be included in our estimate of the PV - mortality relationship.(Elwert and Winship 2014)\nIn the more detailed DAG below we show the mediators whose paths we wish to block (age at diagnosis, stage/grade and the treatment received which includes chemotherapy, surgery and radiation). We also include the receipt of HER2-therapy as a disease specific treatment variable for breast cancer and Rectal vs Colon location for colorectal cancer.\n\n\ncode\nrisk&lt;-dagify(\n  Y ~  PV + M1 + M2 + M3 + C2 + R + YD, PV ~ R,\n    M1 ~PV + C2, M2 ~ PV + C2, M3 ~ PV + C2,\n    M3 ~ M1 + M2 + YD, R ~ C, \n    GT ~ YD + M1 + M2 + C2 + R,  \n  coords =list(\n    x=c(Y=7,C=1.5, R = 1.5, PV=0, M1 = 1.5 , M2 = 2.5 ,M3 = 3,C2 = 7,YD= 5 ,GT = 7), \n    y=c(Y=0,C=-3.5,R = -1.5, PV=0, M1 = 1, M2=3 , M3= 6 , C2 = 3, YD=6, GT = 5  )\n    ),\n  exposure=\"PV\",\n  outcome=\"Y\",\n  labels=c(PV=\"PV\", C= \"Shared Ancestry\" , Y=\" Mortality\", M1 = \"Age at diagnosis\",\n           M2 = \"Stage/grade\", M3=\"Treatment\", C2=\"Mediator-outcome \\n confounders\",\n           R = \"race/ethnicity\", YD = \"year of diagnosis\", GT = \"gene testing\")\n) \n\nset.seed(7)\nset.seed(9670)\nmyplot(risk)\n\n\n\n\n\n\n\n\n\nThere are not many confounders of the direct PV - mortality or PV - mediator relationships as in order to be a confounder it has to cause (requiring it to come before) the PV as well as the outcome. However, the most commonly raised potential confounder of gene outcome relationships is shared ancestry. The primary measure of shared ancestry that we have is the SEER race/ethnicity variable. Of the gene groups we have BRCA1/2 is the only one with an obvious shared ancestry group of Ashkenazi Jews who share a founder mutation. However, apart from this one group it seems that BRCA1/2 prevalence is not uncommon and quite similar across race and ethnic groups(Hall et al. 2009) and the latter seems true for the other gene groups. But we decided to still include this race variable as as a proxy for shared ancestry.\nAgain, the biggest problem with estimating the direct effect of PV on mortality is that once we have included the mediators we have to now block all the potential mediator-outcome confounders labeled collectively in the green box in the DAG. For example, given that we hypothesize that PVs may cause treatment changes, then any confounder of the treatment -&gt; mortality relationship, such as access or quality of care poverty which limits access to treatment, opens up a collider path with respect to the PV mortality relationship. Inclusion of treatment as a collider, while it blocks the mediating path from PV -&gt; Treatment -&gt; Mortality, it will open a path from PV -&gt; treatment &lt;- Poverty -&gt; Mortality. Thus we include the county level variables poverty, rurality as well as state as a proxy for quality and access related potential mediator-outcome confounders.\nA second potential mediator-outcome confounder is the year of diagnosis which can cause treatment changes if cancer therapy changes and also might have an effect on outcome due to other changes in supportive care occur over time. As such it also has to be blocked to avoid a backdoor path from the treatment mediator to the outcome which would bias the PV - mortality relationship. An interesting feature of year of diagnosis is that selection into our cohort changed quite a bit from 2013-2019 as genetic testing rates increased significantly.(Kurian et al. 2023) Thus year of diagnosis is causally related to genetic testing. Given the additional causal pathways from the clinical characteristics of the cancer and race to genetic testing, a pathway opens up from year of diagnosis to mortality as the implied genetic testing covariate is a collider on this pathway.(Elwert and Winship 2014) This explains an odd finding seen in the regression results which is a large decrease in the hazard ratio for later years of diagnosis as genetic testing spreads from the highest risk groups to lower risk groups and the cohorts include an increasing number of people with lower clinical risk.\nPeople do not get into the cohort unless they have a genetic test. This automatically includes genetic testing as a covariate whether we want it or not. Genetic testing is more common in higher risk cancers (early age of diagnosis or high stage and grade) and also potentially causally related to race/ethnicity as well as some of the access and quality variables and the relationships are changing over time. The concern of the selection mechanism would be if it introduced any backdoor paths between PV and mortality. However the DAG is getting a bit complicated to for us to easily detect this at this point.\nFortunately, once we have encoded the causal relationships we propose exist we can use functions that apply an axiomatic system for replacing probability formulas containing the causal relationships with ordinary conditional probabilities. That allows us to identify whether the adjustment set is able to evaluate a specific relationship without bias. This axiomatic system has the name ‘do-calculus’ invented by Judea Pearl.(Pearl 2010) Below we can show that if we condition on the variables in the DAG above the relationship between PV and mortality are d-separated which would allow us to estimate the presence or absence of a direct effect.\n\n\ncode\nrisk1&lt;-dagify(\n  Y ~   M1 + M2 + M3 + C2 + R + YD, PV ~ R,\n    M1 ~PV + C2, M2 ~ PV + C2, M3 ~ PV + C2,\n    M3 ~ M1 + M2 + YD, R ~ C, \n    GT ~ YD + M1 + M2 + C2 + R,  \n  coords =list(\n    x=c(Y=7,C=1.5, R = 1.5, PV=0, M1 = 1.5 , M2 = 2.5 ,M3 = 3,C2 = 7,YD= 5 ,GT = 7), \n    y=c(Y=0,C=-3.5,R = -1.5, PV=0, M1 = 1, M2=3 , M3= 6 , C2 = 3, YD=6, GT = 5  )\n    ),\n  exposure=\"PV\",\n  outcome=\"Y\",\n  labels=c(PV=\"PV\", C= \"Shared Ancestry\" , Y=\" Mortality\", M1 = \"Age at diagnosis\",\n           M2 = \"Stage/grade\", M3=\"Treatment\", C2=\"Mediator-outcome \\n confounders\",\n           R = \"race/ethnicity\", YD = \"year of diagnosis\", GT = \"gene testing\")\n) \nset.seed(3920)\nggdag::ggdag_dseparated(\n  risk1,\n  from = \"PV\",\n  to = \"Y\",\n  controlling_for = c(\"M1\", \"M2\", \"M3\",\"R\",\"C2\",\"GT\",\"YD\"),\n  text = FALSE,\n  use_labels  = \"label\") +\n  theme_dag() +\n  labs(title = \"If we add the confounders of all the mediators then PV and Y \\n are independent as they should be if there is no direct path\")\n\n\n\n\n\n\n\n\n\nBased on this we can argue that we may be able to identify the direct effect of PV on mortality. However, in case it is not obvious the two biggest assumptions in the selection of covariates with respect to identifying the PV - mortality relationship are as follows:\n\nThere are no unmeasured confounders beyond race that capture important shared ancestry features that would cause both the PV and higher mortality.\nThe covariate set of county level variables poverty, rurality as well as state are an adequate proxy for the quality and access related potential mediator-outcome confounders.\n\nAlthough not always clear, both of these assumptions are required for all gene outcome studies if they condition on any treatment or clinical severity variables, not just ours. However, we believe proposing a specific DAG provides a principled way of justifying the selection of covariates and allows us to start to try to identify the key variable sets for making these estimates. Perhaps most importantly it offers a transparent way for others to critique our choices and to propose and defend through additional analyses the need for other covariates.\n\n\n\n\nFixed effects model\nThe fixed effects modeled are estimated using the coxph procedure from the Survival package.(Therneau et al. 2024)\n\n\nUse of multilevel models to estimate gene group random effects\nThe implementation of multilevel models in survival data uses the term frailty models for a survival regression model that includes random effects. The term is often specifically used for those models that only include random effects for the intercept.(Austin 2017) When the random effects are shared by a cluster the models are known as shared frailty models. Given the mathematical form of the survival model, the random intercept in the linear predictor has a multiplicative effect on the hazard function.\nFor our purposes we could propose a data-generating hypothesis for the use of multilevel models that involves viewing the pathogenic variants that have been found in our population as a random sample of all the possible genetic variations that can have an effect on the mortality of people who develop cancer. However, in this case we are primarily using a multilevel model as a strategy to avoid over-fitting. Given that we are fitting 8 gene groups over 5 cancers there are a total of 40 estimates of interest. There is heterogeneity in the size of the gene groups with some quite small. Multilevel modeling can be thought of “as adaptive regularization where the model itself tries to learn how skeptical it should be.”(McElreath 2020) In this sense it has some similarities to other strategies to avoid over-fitting such as ridge regression. The gamma distribution acts as a regularizing prior for the gene effects although in this case the parameters for that prior are learned from the data.\nFor estimation we used the profile EM (expectation-maximization) algorithm as implemented in the FrailtyEM package.(Theodor Adrian Balan and Putter 2019)"
  },
  {
    "objectID": "final_round.html#breast-cancer-models",
    "href": "final_round.html#breast-cancer-models",
    "title": "Main Analyses",
    "section": "Breast Cancer Models",
    "text": "Breast Cancer Models\n\nTriple negative\n\n\n\n\n\n\nSample description and missing data (click to view)\n\n\n\n\n\n\n\ncode\ncan_type=1\ncovar&lt;-eval(as.name(paste0(\"covar\",can_type,sep=\"\")))\nmort &lt;-get_data(cancer_type=can_type) \nmy_labels&lt;-list(agedec ~ \"Age (in decades from mean age)\", race ~ \"Race\", \n                poverty ~ \"Poverty\", rurality ~ \"Rurality\", married ~ \"Married\", \n                yeardx_cat ~ \"Year of diagnosis\", stage ~ \"Stage\", \n                surgcat ~ \"Surgery (Yes=1)\", chemo ~ \"Chemotherapy (Yes=1)\", \n                radiation ~ \"Radiation (Yes=1)\", state~ \"State\", \n                her2therapy ~ \"HER2 treatment (Yes=1)\", grade ~ \"Grade\", \n                pvgroup ~ \"Gene group\")\ngtsummary::tbl_summary(mort,label=my_labels, missing_text=\"missing\",include=covar) |&gt;\n    gtsummary::modify_caption(\"Table 1. Covariates - Triple negative\") |&gt;\n    gtsummary::modify_footnote(label = \"Omitted category listed first for categorical variables\" )\n\n\n\n\n\n\nTable 1. Covariates - Triple negative\n\n\n\n\n\n\nCharacteristic1\nN = 11,8422\n\n\n\n\nAge (in decades from mean age)\n-0.05 (-0.85, 0.75)\n\n\nRace\n\n\n\n\n    NH White\n6,061 (51%)\n\n\n    Asian\n1,105 (9.3%)\n\n\n    Black\n2,078 (18%)\n\n\n    Hispanic\n2,417 (20%)\n\n\n    Other\n181 (1.5%)\n\n\nPoverty\n\n\n\n\n    &lt;10% poverty\n8,100 (68%)\n\n\n    10%-19% poverty\n2,540 (21%)\n\n\n    20%+ poverty\n1,202 (10%)\n\n\nRurality\n\n\n\n\n    rural\n788 (6.7%)\n\n\n    urban\n11,054 (93%)\n\n\nMarried\n6,974 (59%)\n\n\nYear of diagnosis\n\n\n\n\n    2013\n1,348 (11%)\n\n\n    2014\n1,425 (12%)\n\n\n    2015\n1,606 (14%)\n\n\n    2016\n1,529 (13%)\n\n\n    2017\n1,668 (14%)\n\n\n    2018\n1,974 (17%)\n\n\n    2019\n2,292 (19%)\n\n\nStage\n\n\n\n\n    2\n4,022 (37%)\n\n\n    0\n1,671 (16%)\n\n\n    1\n2,986 (28%)\n\n\n    3\n1,660 (15%)\n\n\n    4\n414 (3.9%)\n\n\n    missing\n1,089\n\n\nSurgery (Yes=1)\n7,751 (65%)\n\n\nChemotherapy (Yes=1)\n8,295 (70%)\n\n\nRadiation (Yes=1)\n1,488 (13%)\n\n\nState\n\n\n\n\n    CA\n8,640 (73%)\n\n\n    GA\n3,202 (27%)\n\n\nHER2 treatment (Yes=1)\n318 (2.7%)\n\n\nGrade\n\n\n\n\n    2\n1,890 (18%)\n\n\n    1\n345 (3.2%)\n\n\n    3\n8,287 (78%)\n\n\n    4\n105 (1.0%)\n\n\n    missing\n1,215\n\n\nGene group\n\n\n\n\n    Negative\n7,748 (65%)\n\n\n    ATM\n36 (0.3%)\n\n\n    BRCA 1/2\n1,322 (11%)\n\n\n    CHEK2\n69 (0.6%)\n\n\n    Lynch Syndrome\n48 (0.4%)\n\n\n    Other PV\n379 (3.2%)\n\n\n    PALB2\n128 (1.1%)\n\n\n    VUS only\n2,112 (18%)\n\n\n\n1 Omitted category listed first for categorical variables\n\n\n2 Median (Q1, Q3); n (%)\n\n\n\n\n\n\n\n\n\n\n\n\nModel output\n\nRandom effects for gene group (as shown in figure 1)\n\n\ncode\n# random effects\nif(params$frailty==\"on\") {\n  m_emfrail&lt;-get_random(mort,can_type,covar)\n}\n\n# fixed effects\nm_fixed&lt;-get_fixed(mort,covar)\n\n# graph\n## process fixed effects\nfe&lt;-process_fixed(m_fixed)\n## process random effects\nfile_name=paste(\"data/\",\"m_emfrail\",can_type,\".Rdata\",sep=\"\")\nload(file_name)\nlogz&lt;-process_random(m_emfrail)\n## combine and graph\ndatt&lt;-combine_effects(fe,logz)\np1&lt;-graph_effects_vert(datt)\np1 &lt;- forestploter::edit_plot(p1,\n               col = 1,\n               row = c(1:3,7),\n               gp = gpar(fontface = \"italic\"))\np1 &lt;- forestploter::insert_text(p1, text = \"Triple-Negative Breast Cancer\",\n              part = \"header\",\n              col = 1:3,\n              gp = gpar(fontface = \"bold\"))\nmy_pval&lt;-1/2*pchisq(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],1, lower.tail=FALSE)\nmy_chi&lt;-paste0(\"Likelihood ratio test for heterogeneity \\U{03A7}\\U{00B2} = \",\n               round(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],2),\", p\",pvalr(my_pval))\np1 &lt;- forestploter::insert_text(p1, text = my_chi,\n   part = \"header\", just = \"right\",\n   col = 3, gp = gpar(fontsize=10) )\n\nggsave(p1,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"svg\",sep=\"\"))\nggsave(p1,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"pdf\",sep=\"\"),device=cairo_pdf)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGene\nATM\n \nBRCA 1/2\nCI\nCHEK2\nLynch Syndrome\nNegative\nOther PV\nPALB2\nVUS only\n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n3.7 (1.8, 7.7)\n1.2 (0.8, 1.6)\n0.6 (0.4, 0.9)\n0.7 (0.6, 0.8)\n0.3 (0.1, 1.2)\n0.9 (0.6, 1.3)\n2.0 (0.9, 4.4)\n1.1 (0.7, 1.5)\n1.0 (0.8, 1.3)\n1.1 (1.0, 1.2)\n0.9 (0.6, 1.3)\n1.0 (0.7, 1.3)\n0.7 (0.4, 1.3)\n0.9 (0.7, 1.3)\n1.0 (0.7, 1.3)\n1.1 (0.9, 1.2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.25\n0.5\n2\n4\nLower risk\n\n\nHigher risk\n\n\nTriple-Negative Breast Cancer\nLikelihood ratio test for heterogeneity Χ² = 16.19, p&lt; 0.001\n\n\n\n\n\n\n\n\nFixed effects model (click to view)\n\n\n\n\n\n\n\ncode\ngtsummary::tbl_regression(m_fixed,exponentiate=TRUE,label=my_labels)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR1\n95% CI1\np-value\n\n\n\n\nAge (in decades from mean age)\n1.00\n0.95, 1.05\n&gt;0.9\n\n\nRace\n\n\n\n\n\n\n\n\n    NH White\n—\n—\n\n\n\n\n    Asian\n0.71\n0.55, 0.92\n0.010\n\n\n    Black\n1.11\n0.95, 1.29\n0.2\n\n\n    Hispanic\n1.09\n0.93, 1.27\n0.3\n\n\n    Other\n0.38\n0.14, 1.03\n0.057\n\n\nPoverty\n\n\n\n\n\n\n\n\n    &lt;10% poverty\n—\n—\n\n\n\n\n    10%-19% poverty\n0.91\n0.77, 1.07\n0.2\n\n\n    20%+ poverty\n1.09\n0.90, 1.33\n0.4\n\n\nRurality\n\n\n\n\n\n\n\n\n    rural\n—\n—\n\n\n\n\n    urban\n0.87\n0.71, 1.07\n0.2\n\n\nMarried\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.97\n0.86, 1.09\n0.6\n\n\nYear of diagnosis\n\n\n\n\n\n\n\n\n    2013\n—\n—\n\n\n\n\n    2014\n1.16\n0.95, 1.41\n0.2\n\n\n    2015\n1.14\n0.94, 1.38\n0.2\n\n\n    2016\n0.89\n0.72, 1.09\n0.3\n\n\n    2017\n0.87\n0.70, 1.07\n0.2\n\n\n    2018\n0.57\n0.46, 0.72\n&lt;0.001\n\n\n    2019\n0.44\n0.34, 0.57\n&lt;0.001\n\n\nStage\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    0\n0.07\n0.04, 0.13\n&lt;0.001\n\n\n    1\n0.37\n0.30, 0.45\n&lt;0.001\n\n\n    3\n3.67\n3.20, 4.20\n&lt;0.001\n\n\n    4\n11.3\n9.49, 13.4\n&lt;0.001\n\n\nSurgery (Yes=1)\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.60\n1.37, 1.86\n&lt;0.001\n\n\nChemotherapy (Yes=1)\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.81\n0.67, 0.99\n0.035\n\n\nRadiation (Yes=1)\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.60\n1.33, 1.94\n&lt;0.001\n\n\nState\n\n\n\n\n\n\n\n\n    CA\n—\n—\n\n\n\n\n    GA\n1.25\n1.07, 1.45\n0.004\n\n\nHER2 treatment (Yes=1)\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.14\n0.86, 1.51\n0.4\n\n\nGrade\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    1\n0.79\n0.47, 1.32\n0.4\n\n\n    3\n0.95\n0.81, 1.11\n0.5\n\n\n    4\n0.81\n0.38, 1.73\n0.6\n\n\nGene group\n\n\n\n\n\n\n\n\n    Negative\n—\n—\n\n\n\n\n    ATM\n3.66\n1.63, 8.21\n0.002\n\n\n    BRCA 1/2\n0.62\n0.51, 0.75\n&lt;0.001\n\n\n    CHEK2\n0.34\n0.08, 1.38\n0.13\n\n\n    Lynch Syndrome\n1.97\n0.81, 4.75\n0.13\n\n\n    Other PV\n0.89\n0.62, 1.27\n0.5\n\n\n    PALB2\n0.73\n0.40, 1.33\n0.3\n\n\n    VUS only\n0.99\n0.84, 1.15\n0.9\n\n\n\n1 HR = Hazard Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nNote the decreasing hazard ratio with year of diagnosis that is a product of the spread of genetic testing to lower clinical risk groups as discussed as part of the variable selection rationale in (model-strat?) above.\n\n\n\n\n\nTests of heterogeneity\n\n\ncode\nfvar&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$fr_var),scientific=FALSE)\nca&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$ca_test),scientific=FALSE)\nlrt&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$loglik),scientific=FALSE)\n\np11&lt;-table_fig(fvar,tbl_title=\"Variance\",.9)\np12&lt;-table_fig(ca,tbl_title=\"Commenges-Andersen test\",1)\np13&lt;-table_fig(lrt,tbl_title=\"Likelihood ratio test\",.8)\ncowplot::plot_grid(p11,p12,p13,nrow=1)\n\n\n\n\n\n\n\n\n\n\n\n\n\nBreast HER2+\n\n\n\n\n\n\nSample description and missing data (click to view)\n\n\n\n\n\n\n\ncode\ncovar2&lt;-covar1\ncan_type=2\ncovar&lt;-eval(as.name(paste0(\"covar\",can_type,sep=\"\")))\nmort &lt;-get_data(cancer_type=can_type)\n# mylabels as defined above for triple negative dz\ngtsummary::tbl_summary(mort,label=my_labels, missing_text=\"missing\",include=covar) |&gt;\n    gtsummary::modify_caption(\"Table 1. Covariates - HER2+\") |&gt;\n    gtsummary::modify_footnote(label = \"Omitted category listed first for categorical variables\" )\n\n\n\n\n\n\nTable 1. Covariates - HER2+\n\n\n\n\n\n\nCharacteristic1\nN = 9,9572\n\n\n\n\nAge (in decades from mean age)\n-0.24 (-0.84, 0.76)\n\n\nRace\n\n\n\n\n    NH White\n5,453 (55%)\n\n\n    Asian\n1,346 (14%)\n\n\n    Black\n1,149 (12%)\n\n\n    Hispanic\n1,928 (19%)\n\n\n    Other\n81 (0.8%)\n\n\nPoverty\n\n\n\n\n    &lt;10% poverty\n7,011 (70%)\n\n\n    10%-19% poverty\n2,054 (21%)\n\n\n    20%+ poverty\n892 (9.0%)\n\n\nRurality\n\n\n\n\n    rural\n612 (6.1%)\n\n\n    urban\n9,345 (94%)\n\n\nMarried\n6,244 (63%)\n\n\nYear of diagnosis\n\n\n\n\n    2013\n1,066 (11%)\n\n\n    2014\n1,182 (12%)\n\n\n    2015\n1,435 (14%)\n\n\n    2016\n1,442 (14%)\n\n\n    2017\n1,477 (15%)\n\n\n    2018\n1,556 (16%)\n\n\n    2019\n1,799 (18%)\n\n\nStage\n\n\n\n\n    2\n3,508 (37%)\n\n\n    0\n276 (2.9%)\n\n\n    1\n3,992 (42%)\n\n\n    3\n1,173 (12%)\n\n\n    4\n547 (5.8%)\n\n\n    missing\n461\n\n\nSurgery (Yes=1)\n6,812 (68%)\n\n\nChemotherapy (Yes=1)\n8,317 (84%)\n\n\nRadiation (Yes=1)\n1,018 (10%)\n\n\nState\n\n\n\n\n    CA\n7,400 (74%)\n\n\n    GA\n2,557 (26%)\n\n\nHER2 treatment (Yes=1)\n7,087 (71%)\n\n\nGrade\n\n\n\n\n    2\n3,639 (38%)\n\n\n    1\n455 (4.8%)\n\n\n    3\n5,349 (56%)\n\n\n    4\n36 (0.4%)\n\n\n    missing\n478\n\n\nGene group\n\n\n\n\n    Negative\n6,829 (69%)\n\n\n    ATM\n108 (1.1%)\n\n\n    BRCA 1/2\n351 (3.5%)\n\n\n    CHEK2\n209 (2.1%)\n\n\n    Lynch Syndrome\n25 (0.3%)\n\n\n    Other PV\n300 (3.0%)\n\n\n    PALB2\n45 (0.5%)\n\n\n    VUS only\n2,090 (21%)\n\n\n\n1 Omitted category listed first for categorical variables\n\n\n2 Median (Q1, Q3); n (%)\n\n\n\n\n\n\n\n\n\n\n\n\nModel output\n\nRandom effects for gene group (as shown in figure 1)\n\n\ncode\n# random effects\nif(params$frailty==\"on\") {\n    m_emfrail&lt;-get_random(mort,can_type,covar)  #random w. Lynch, fixed w.out\n}\n\n# fixed effects\nlevels(mort$pvgroup)&lt;-c(\"Negative\",\"ATM\",\"BRCA 1/2\",\"CHEK2\",\"Other PV\",\"Other PV\",\"PALB2\",\"VUS only\") # Lynch(4) combined w other(6)\nm_fixed&lt;-get_fixed(mort,covar)\n\n# graph\n## process fixed effects\nfe&lt;-process_fixed(m_fixed)\n## process random effects\nfile_name=paste(\"data/\",\"m_emfrail\",can_type,\".Rdata\",sep=\"\")\nload(file_name)\nlogz&lt;-process_random(m_emfrail)\n## combine and graph\ndatt&lt;-combine_effects(fe,logz)  |&gt;\n      mutate(type= replace_na(type,\"fixed effects\"))\np2&lt;-graph_effects_vert(datt)\np2 &lt;- forestploter::edit_plot(p2,\n               col = 1,\n               row = c(1:3,7),\n               gp = gpar(fontface = \"italic\"))\np2 &lt;- forestploter::insert_text(p2, text = expression(bold(paste(bolditalic(\"HER2\"),\"-Positive Breast Cancer\"))),\n              part = \"header\",\n              col = 1:3)\nmy_pval&lt;-1/2*pchisq(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],1, lower.tail=FALSE)\nmy_chi&lt;-paste0(\"Likelihood ratio test for heterogeneity \\U{03A7}\\U{00B2} = \",round(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],2),\", p\",pvalr(my_pval))\np2 &lt;- forestploter::insert_text(p2, text = my_chi,\n   part = \"header\", just = \"right\",\n   col = 3, gp = gpar(fontsize=10) )\n\nggsave(p2,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"svg\",sep=\"\"))\nggsave(p2,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"pdf\",sep=\"\"),device=cairo_pdf)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGene\nATM\n \nBRCA 1/2\nCI\nCHEK2\nLynch Syndrome\nNegative\nOther PV\nPALB2\nVUS only\n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n0.8 (0.2, 2.7)\n1.0 (0.7, 1.2)\n1.9 (1.0, 3.6)\n1.0 (0.8, 1.3)\n0.3 (0.0, 1.4)\n0.9 (0.7, 1.2)\nNA (NA, NA)\n1.0 (0.7, 1.3)\n1.9 (1.1, 3.1)\n1.2 (1.0, 1.3)\n1.0 (0.4, 2.2)\n1.0 (0.7, 1.2)\n1.7 (0.5, 6.0)\n1.0 (0.8, 1.3)\n1.5 (0.9, 2.5)\n1.0 (0.8, 1.1)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.25\n0.5\n2\n4\nLower risk\n\n\nHigher risk\n\n\nHER2\n-Positive Breast Cancer\nLikelihood ratio test for heterogeneity Χ² = 0.89, p= 0.17\n\n\nThe fixed effects cox model does not converge to stable estimates for the pvgroup when the Lynch genes are included. There are relatively few observations (25) in those with HER2+ breast cancer. Thus Lynch was collapsed into the “Other PV” category for the fixed effects analysis. That is why the estimate is missing in the above figure.\n\n\n\n\n\n\nFixed effects model (click to view)\n\n\n\n\n\n\n\ncode\nmy_labels&lt;-list(agedec ~ \"Age (in decades)\", race ~ \"Race\", poverty ~ \"Poverty\",\n                rurality ~ \"Rurality\", married ~ \"Married\", yeardx_cat ~ \"Year of diagnosis\",\n                stage ~ \"Stage\", surgcat ~ \"Surgery\", chemo ~ \"Chemotherapy\",\n                radiation ~ \"Radiation\", state~ \"State\", her2therapy ~ \"HER2 treatment\",\n                grade ~ \"Grade\", pvgroup ~ \"Gene group\")\ngtsummary::tbl_regression(m_fixed,exponentiate=TRUE,label=my_labels)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR1\n95% CI1\np-value\n\n\n\n\nAge (in decades)\n1.10\n1.01, 1.19\n0.028\n\n\nRace\n\n\n\n\n\n\n\n\n    NH White\n—\n—\n\n\n\n\n    Asian\n1.09\n0.80, 1.50\n0.6\n\n\n    Black\n1.42\n1.08, 1.88\n0.013\n\n\n    Hispanic\n1.29\n0.99, 1.69\n0.057\n\n\n    Other\n0.86\n0.21, 3.47\n0.8\n\n\nPoverty\n\n\n\n\n\n\n\n\n    &lt;10% poverty\n—\n—\n\n\n\n\n    10%-19% poverty\n0.99\n0.75, 1.30\n&gt;0.9\n\n\n    20%+ poverty\n1.75\n1.27, 2.42\n&lt;0.001\n\n\nRurality\n\n\n\n\n\n\n\n\n    rural\n—\n—\n\n\n\n\n    urban\n1.30\n0.84, 2.01\n0.2\n\n\nMarried\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.78\n0.64, 0.94\n0.011\n\n\nYear of diagnosis\n\n\n\n\n\n\n\n\n    2013\n—\n—\n\n\n\n\n    2014\n1.02\n0.76, 1.37\n&gt;0.9\n\n\n    2015\n0.83\n0.61, 1.13\n0.2\n\n\n    2016\n0.89\n0.64, 1.23\n0.5\n\n\n    2017\n0.81\n0.56, 1.17\n0.3\n\n\n    2018\n0.65\n0.41, 1.02\n0.060\n\n\n    2019\n0.67\n0.38, 1.17\n0.2\n\n\nStage\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    0\n0.08\n0.02, 0.32\n&lt;0.001\n\n\n    1\n0.34\n0.24, 0.49\n&lt;0.001\n\n\n    3\n3.01\n2.36, 3.86\n&lt;0.001\n\n\n    4\n8.84\n6.82, 11.5\n&lt;0.001\n\n\nSurgery\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.48\n1.12, 1.94\n0.005\n\n\nChemotherapy\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.56\n0.41, 0.77\n&lt;0.001\n\n\nRadiation\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.42\n1.06, 1.92\n0.020\n\n\nState\n\n\n\n\n\n\n\n\n    CA\n—\n—\n\n\n\n\n    GA\n1.54\n1.19, 1.99\n&lt;0.001\n\n\nHER2 treatment\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.66\n0.52, 0.83\n&lt;0.001\n\n\nGrade\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    1\n1.07\n0.58, 1.95\n0.8\n\n\n    3\n1.41\n1.13, 1.75\n0.002\n\n\n    4\n0.83\n0.11, 6.02\n0.9\n\n\nGene group\n\n\n\n\n\n\n\n\n    Negative\n—\n—\n\n\n\n\n    ATM\n0.43\n0.11, 1.72\n0.2\n\n\n    BRCA 1/2\n1.03\n0.64, 1.67\n0.9\n\n\n    CHEK2\n0.14\n0.02, 1.02\n0.052\n\n\n    Other PV\n0.53\n0.24, 1.20\n0.13\n\n\n    PALB2\n0.93\n0.23, 3.80\n&gt;0.9\n\n\n    VUS only\n0.79\n0.60, 1.04\n0.090\n\n\n\n1 HR = Hazard Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nNote the decreasing hazard ratio with year of diagnosis that is a product of the spread of genetic testing to lower clinical risk groups as discussed as part of the variable selection rationale in (model-strat?) above.\n\n\n\n\n\nTests of heterogeneity\n\n\ncode\nfvar&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$fr_var),scientific=FALSE)\nca&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$ca_test),scientific=FALSE)\nlrt&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$loglik),scientific=FALSE)\n\np11&lt;-table_fig(fvar,tbl_title=\"Variance\",.9)\np12&lt;-table_fig(ca,tbl_title=\"Commenges-Andersen test\",1)\np13&lt;-table_fig(lrt,tbl_title=\"Likelihood ratio test\",.8)\ncowplot::plot_grid(p11,p12,p13,nrow=1)\n\n\n\n\n\n\n\n\n\n\n\n\n\nBreast ER/PR+, HER2-\n\n\n\n\n\n\nSample description and missing data (click to view)\n\n\n\n\n\n\n\ncode\ncovar3&lt;-covar1\ncan_type=3  # use this code for cancer_types 2,3,5\ncovar&lt;-eval(as.name(paste0(\"covar\",can_type,sep=\"\")))\nmort&lt;-get_data(cancer_type=can_type)\n# mylabels as defined above for triple negative dz\ngtsummary::tbl_summary(mort,label=my_labels, missing_text=\"missing\",include=covar) |&gt;\n    gtsummary::modify_caption(\"Table 1. Covariates - ER/PR+,HER2-\") |&gt;\n    gtsummary::modify_footnote(label = \"Omitted category listed first for categorical variables\" )\n\n\n\n\n\n\nTable 1. Covariates - ER/PR+,HER2-\n\n\n\n\n\n\nCharacteristic1\nN = 48,4732\n\n\n\n\nAge (in decades)\n-0.19 (-0.99, 0.91)\n\n\nRace\n\n\n\n\n    NH White\n29,727 (61%)\n\n\n    Asian\n5,827 (12%)\n\n\n    Black\n4,697 (9.7%)\n\n\n    Hispanic\n7,751 (16%)\n\n\n    Other\n471 (1.0%)\n\n\nPoverty\n\n\n\n\n    &lt;10% poverty\n34,965 (72%)\n\n\n    10%-19% poverty\n9,672 (20%)\n\n\n    20%+ poverty\n3,836 (7.9%)\n\n\nRurality\n\n\n\n\n    rural\n2,733 (5.6%)\n\n\n    urban\n45,740 (94%)\n\n\nMarried\n30,684 (63%)\n\n\nYear of diagnosis\n\n\n\n\n    2013\n4,811 (9.9%)\n\n\n    2014\n5,328 (11%)\n\n\n    2015\n6,039 (12%)\n\n\n    2016\n6,325 (13%)\n\n\n    2017\n6,827 (14%)\n\n\n    2018\n8,377 (17%)\n\n\n    2019\n10,766 (22%)\n\n\nStage\n\n\n\n\n    2\n10,033 (21%)\n\n\n    0\n8,001 (17%)\n\n\n    1\n24,382 (52%)\n\n\n    3\n3,350 (7.1%)\n\n\n    4\n1,172 (2.5%)\n\n\n    missing\n1,535\n\n\nSurgery\n25,282 (52%)\n\n\nChemotherapy\n15,340 (32%)\n\n\nRadiation\n16,196 (33%)\n\n\nState\n\n\n\n\n    CA\n36,878 (76%)\n\n\n    GA\n11,595 (24%)\n\n\nHER2 treatment\n747 (1.5%)\n\n\nGrade\n\n\n\n\n    2\n23,404 (50%)\n\n\n    1\n12,285 (26%)\n\n\n    3\n11,262 (24%)\n\n\n    4\n209 (0.4%)\n\n\n    missing\n1,313\n\n\nGene group\n\n\n\n\n    Negative\n33,618 (69%)\n\n\n    ATM\n399 (0.8%)\n\n\n    BRCA 1/2\n1,975 (4.1%)\n\n\n    CHEK2\n723 (1.5%)\n\n\n    Lynch Syndrome\n206 (0.4%)\n\n\n    Other PV\n1,398 (2.9%)\n\n\n    PALB2\n343 (0.7%)\n\n\n    VUS only\n9,811 (20%)\n\n\n\n1 Omitted category listed first for categorical variables\n\n\n2 Median (Q1, Q3); n (%)\n\n\n\n\n\n\n\n\n\n\n\n\nModel output\n\nRandom effects for gene group (as shown in figure 1)\n\n\ncode\n# random effects\nif(params$frailty==\"on\") {\n  m_emfrail&lt;-get_random(mort,can_type,covar)\n}\n\n# fixed effects\nm_fixed&lt;-get_fixed(mort,covar)\n\n# graph\n## process fixed effects\nfe&lt;-process_fixed(m_fixed)\n## process random effects\nfile_name=paste(\"data/\",\"m_emfrail\",can_type,\".Rdata\",sep=\"\")\nload(file_name)\nlogz&lt;-process_random(m_emfrail)\n## combine and graph\ndatt&lt;-combine_effects(fe,logz)\n#plot(graph_effects_vert(datt)) \np3&lt;-graph_effects_vert(datt)\np3 &lt;- forestploter::edit_plot(p3,\n               col = 1,\n               row = c(1:3,7),\n               gp = gpar(fontface = \"italic\"))\np3 &lt;- forestploter::insert_text(p3, text = expression(bold(paste(\"ER/PR-Positive\",bolditalic(\" HER2\"),\"-Negative Breast Cancer\"))),\n              part = \"header\",\n              col = 1:3)\nmy_pval&lt;-1/2*pchisq(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],1, lower.tail=FALSE)\nmy_chi&lt;-paste0(\"Likelihood ratio test for heterogeneity \\U{03A7}\\U{00B2} = \",round(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],2),\", p\",pvalr(my_pval))\np3 &lt;- forestploter::insert_text(p3, text = my_chi,\n   part = \"header\", just = \"right\",\n   col = 3, gp = gpar(fontsize=10) )\n\nggsave(p3,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"svg\",sep=\"\"))\nggsave(p3,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"pdf\",sep=\"\"),device=cairo_pdf)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGene\nATM\n \nBRCA 1/2\nCI\nCHEK2\nLynch Syndrome\nNegative\nOther PV\nPALB2\nVUS only\n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n0.7 (0.4, 1.2)\n1.0 (1.0, 1.0)\n1.1 (0.9, 1.4)\n1.0 (1.0, 1.0)\n0.8 (0.5, 1.3)\n1.0 (1.0, 1.0)\n1.8 (1.0, 3.1)\n1.0 (1.0, 1.0)\n0.9 (0.8, 1.1)\n1.0 (1.0, 1.0)\n1.0 (0.7, 1.3)\n1.0 (1.0, 1.0)\n1.1 (0.7, 1.7)\n1.0 (1.0, 1.0)\n0.9 (0.7, 1.0)\n1.0 (1.0, 1.0)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.25\n0.5\n2\n4\nLower risk\n\n\nHigher risk\n\n\nER/PR-Positive\n HER2\n-Negative Breast Cancer\nLikelihood ratio test for heterogeneity Χ² = 0, p= 0.50\n\n\n\n\n\n\n\n\nFixed effects model (click to view)\n\n\n\n\n\n\n\ncode\nmy_labels&lt;-list(agedec ~ \"Age (in decades)\", race ~ \"Race\", poverty ~ \"Poverty\",\n                rurality ~ \"Rurality\", married ~ \"Married\", yeardx_cat ~ \"Year of diagnosis\",\n                stage ~ \"Stage\", surgcat ~ \"Surgery\", chemo ~ \"Chemotherapy\",\n                radiation ~ \"Radiation\", state~ \"State\", her2therapy ~ \"HER2 treatment\",\n                grade ~ \"Grade\", pvgroup ~ \"Gene group\")\ngtsummary::tbl_regression(m_fixed,exponentiate=TRUE,label=my_labels)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR1\n95% CI1\np-value\n\n\n\n\nAge (in decades)\n1.24\n1.19, 1.30\n&lt;0.001\n\n\nRace\n\n\n\n\n\n\n\n\n    NH White\n—\n—\n\n\n\n\n    Asian\n0.91\n0.76, 1.10\n0.4\n\n\n    Black\n1.40\n1.20, 1.63\n&lt;0.001\n\n\n    Hispanic\n1.14\n0.98, 1.32\n0.082\n\n\n    Other\n0.90\n0.45, 1.80\n0.8\n\n\nPoverty\n\n\n\n\n\n\n\n\n    &lt;10% poverty\n—\n—\n\n\n\n\n    10%-19% poverty\n1.20\n1.04, 1.38\n0.012\n\n\n    20%+ poverty\n1.51\n1.26, 1.81\n&lt;0.001\n\n\nRurality\n\n\n\n\n\n\n\n\n    rural\n—\n—\n\n\n\n\n    urban\n1.0\n0.81, 1.22\n&gt;0.9\n\n\nMarried\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.79\n0.71, 0.87\n&lt;0.001\n\n\nYear of diagnosis\n\n\n\n\n\n\n\n\n    2013\n—\n—\n\n\n\n\n    2014\n0.82\n0.70, 0.96\n0.016\n\n\n    2015\n0.82\n0.70, 0.97\n0.017\n\n\n    2016\n0.76\n0.64, 0.90\n0.002\n\n\n    2017\n0.60\n0.49, 0.73\n&lt;0.001\n\n\n    2018\n0.60\n0.48, 0.75\n&lt;0.001\n\n\n    2019\n0.53\n0.41, 0.68\n&lt;0.001\n\n\nStage\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    0\n0.14\n0.10, 0.20\n&lt;0.001\n\n\n    1\n0.52\n0.44, 0.61\n&lt;0.001\n\n\n    3\n2.95\n2.58, 3.38\n&lt;0.001\n\n\n    4\n12.2\n10.6, 14.2\n&lt;0.001\n\n\nSurgery\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.46\n1.28, 1.67\n&lt;0.001\n\n\nChemotherapy\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.30\n1.14, 1.49\n&lt;0.001\n\n\nRadiation\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.95\n0.82, 1.10\n0.5\n\n\nState\n\n\n\n\n\n\n\n\n    CA\n—\n—\n\n\n\n\n    GA\n1.54\n1.35, 1.76\n&lt;0.001\n\n\nHER2 treatment\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.01\n0.79, 1.29\n&gt;0.9\n\n\nGrade\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    1\n0.64\n0.53, 0.77\n&lt;0.001\n\n\n    3\n2.17\n1.95, 2.42\n&lt;0.001\n\n\n    4\n1.02\n0.32, 3.18\n&gt;0.9\n\n\nGene group\n\n\n\n\n\n\n\n\n    Negative\n—\n—\n\n\n\n\n    ATM\n0.75\n0.39, 1.44\n0.4\n\n\n    BRCA 1/2\n1.23\n1.03, 1.47\n0.025\n\n\n    CHEK2\n0.91\n0.58, 1.44\n0.7\n\n\n    Lynch Syndrome\n1.97\n1.05, 3.68\n0.034\n\n\n    Other PV\n1.07\n0.77, 1.50\n0.7\n\n\n    PALB2\n1.20\n0.73, 1.98\n0.5\n\n\n    VUS only\n0.94\n0.81, 1.09\n0.4\n\n\n\n1 HR = Hazard Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nNote the decreasing hazard ratio with year of diagnosis that is a product of the spread of genetic testing to lower clinical risk groups as discussed as part of the variable selection rationale in (model-strat?) above.\n\n\n\n\n\nTests of heterogeneity\n\n\ncode\nfvar&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$fr_var),scientific=FALSE)\nca&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$ca_test),scientific=FALSE)\nlrt&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$loglik),scientific=FALSE)\n\np11&lt;-table_fig(fvar,tbl_title=\"Variance\",.9)\np12&lt;-table_fig(ca,tbl_title=\"Commenges-Andersen test\",1)\np13&lt;-table_fig(lrt,tbl_title=\"Likelihood ratio test\",.8)\ncowplot::plot_grid(p11,p12,p13,nrow=1)"
  },
  {
    "objectID": "final_round.html#colorectal",
    "href": "final_round.html#colorectal",
    "title": "Main Analyses",
    "section": "Colorectal",
    "text": "Colorectal\n\n\n\n\n\n\nSample description and missing data (click to view)\n\n\n\n\n\n\n\ncode\ncovar4&lt;-c(\"agedec\",\"race\",\"sex\",\"poverty\",\"rurality\",\"married\",\"yeardx_cat\",\"stage\",\n          \"surgcat\",\"chemo\",\"radiation\",\"state\",\"colon_rectal\",\"grade\",\"pvgroup\")  #colorectal\ncan_type=4   \ncovar&lt;-eval(as.name(paste0(\"covar\",can_type,sep=\"\")))\nmort&lt;-get_data(cancer_type=can_type) \n\nmy_labels&lt;-list(agedec ~ \"Age (in decades from mean age)\", race ~ \"Race\", sex ~ \"Sex\",\n                poverty ~ \"Poverty\", rurality ~ \"Rurality\", married ~ \"Married\", \n                yeardx_cat ~ \"Year of diagnosis\", stage ~ \"Stage\", \n                surgcat ~ \"Surgery (Yes=1)\", chemo ~ \"Chemotherapy (Yes=1)\", \n                radiation ~ \"Radiation (Yes=1)\", state~ \"State\", \n                colon_rectal ~ \"Colorectal (Rectal=1)\", grade ~ \"Grade\", \n                pvgroup ~ \"Gene group\")\ngtsummary::tbl_summary(mort,label=my_labels, missing_text=\"missing\",include=covar) |&gt;\n    gtsummary::modify_caption(\"Table 1. Covariates - Colorectal\")  |&gt;\n    gtsummary::modify_footnote(label = \"Omitted category listed first for categorical variables\" )\n\n\n\n\n\n\nTable 1. Covariates - Colorectal\n\n\n\n\n\n\nCharacteristic1\nN = 5,8222\n\n\n\n\nAge (in decades from mean age)\n-0.20 (-1.00, 1.00)\n\n\nRace\n\n\n\n\n    NH White\n3,396 (58%)\n\n\n    Asian\n589 (10%)\n\n\n    Black\n534 (9.2%)\n\n\n    Hispanic\n1,244 (21%)\n\n\n    Other\n59 (1.0%)\n\n\nSex\n\n\n\n\n    female\n3,148 (54%)\n\n\n    male\n2,674 (46%)\n\n\nPoverty\n\n\n\n\n    &lt;10% poverty\n3,915 (67%)\n\n\n    10%-19% poverty\n1,315 (23%)\n\n\n    20%+ poverty\n592 (10%)\n\n\nRurality\n\n\n\n\n    rural\n399 (6.9%)\n\n\n    urban\n5,423 (93%)\n\n\nMarried\n3,531 (61%)\n\n\nYear of diagnosis\n\n\n\n\n    2013\n366 (6.3%)\n\n\n    2014\n509 (8.7%)\n\n\n    2015\n638 (11%)\n\n\n    2016\n787 (14%)\n\n\n    2017\n941 (16%)\n\n\n    2018\n1,103 (19%)\n\n\n    2019\n1,478 (25%)\n\n\nStage\n\n\n\n\n    2\n1,377 (25%)\n\n\n    0\n146 (2.6%)\n\n\n    1\n1,100 (20%)\n\n\n    3\n1,770 (32%)\n\n\n    4\n1,143 (21%)\n\n\n    missing\n286\n\n\nSurgery (Yes=1)\n4,798 (82%)\n\n\nChemotherapy (Yes=1)\n3,344 (57%)\n\n\nRadiation (Yes=1)\n834 (14%)\n\n\nState\n\n\n\n\n    CA\n4,483 (77%)\n\n\n    GA\n1,339 (23%)\n\n\nColorectal (Rectal=1)\n\n\n\n\n    colon\n4,148 (71%)\n\n\n    rectal\n1,674 (29%)\n\n\nGrade\n\n\n\n\n    2\n3,609 (68%)\n\n\n    1\n722 (14%)\n\n\n    3\n881 (17%)\n\n\n    4\n103 (1.9%)\n\n\n    missing\n507\n\n\nGene group\n\n\n\n\n    Negative\n3,468 (60%)\n\n\n    ATM\n46 (0.8%)\n\n\n    BRCA 1/2\n88 (1.5%)\n\n\n    CHEK2\n48 (0.8%)\n\n\n    Lynch Syndrome\n661 (11%)\n\n\n    Other PV\n308 (5.3%)\n\n\n    PALB2\n9 (0.2%)\n\n\n    VUS only\n1,194 (21%)\n\n\n\n1 Omitted category listed first for categorical variables\n\n\n2 Median (Q1, Q3); n (%)\n\n\n\n\n\n\n\n\n\n\n\n\nModel output\n\nRandom effects for gene group (as shown in figure 1)\n\n\ncode\n# random effects\nif(params$frailty==\"on\") {\n  m_emfrail&lt;-get_random(mort,can_type,covar)\n}\n\n# fixed effects\nm_fixed&lt;-get_fixed(mort,covar)\n\n# graph\n## process fixed effects\nfe&lt;-process_fixed(m_fixed)\n## process random effects\nfile_name=paste(\"data/\",\"m_emfrail\",can_type,\".Rdata\",sep=\"\")\nload(file_name)\nlogz&lt;-process_random(m_emfrail)\n## combine and graph\ndatt&lt;-combine_effects(fe,logz)\np4&lt;-graph_effects_vert(datt)\np4 &lt;- forestploter::edit_plot(p4,\n               col = 1,\n               row = c(1:3,7),\n               gp = gpar(fontface = \"italic\"))\np4 &lt;- forestploter::insert_text(p4, text = \"Colorectal Cancer\",\n              part = \"header\",\n              col = 1:3,\n              gp = gpar(fontface = \"bold\"))\nmy_pval&lt;-1/2*pchisq(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],1, lower.tail=FALSE)\nmy_chi&lt;-paste0(\"Likelihood ratio test for heterogeneity \\U{03A7}\\U{00B2} = \",round(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],2),\", p\",pvalr(my_pval))\np4 &lt;- forestploter::insert_text(p4, text = my_chi,\n   part = \"header\", just = \"right\",\n   col = 3, gp = gpar(fontsize=10) )\n\nggsave(p4,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"svg\",sep=\"\"))\nggsave(p4,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"pdf\",sep=\"\"),device=cairo_pdf)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGene\nATM\n \nBRCA 1/2\nCI\nCHEK2\nLynch Syndrome\nNegative\nOther PV\nPALB2\nVUS only\n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n1.3 (0.7, 2.5)\n1.1 (0.7, 1.4)\n1.5 (1.0, 2.4)\n1.2 (0.9, 1.6)\n1.0 (0.5, 1.8)\n1.0 (0.7, 1.4)\n0.6 (0.4, 0.8)\n0.7 (0.6, 0.9)\n1.0 (0.8, 1.3)\n1.1 (1.0, 1.2)\n0.8 (0.5, 1.1)\n0.9 (0.7, 1.2)\n1.4 (0.5, 3.9)\n1.0 (0.7, 1.4)\n0.8 (0.6, 1.1)\n0.9 (0.8, 1.1)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.25\n0.5\n2\n4\nLower risk\n\n\nHigher risk\n\n\nColorectal Cancer\nLikelihood ratio test for heterogeneity Χ² = 4.47, p= 0.017\n\n\n\n\n\n\n\n\nFixed effects model (click to view)\n\n\n\n\n\n\n\ncode\nmy_labels&lt;-list(agedec ~ \"Age (in decades)\", race ~ \"Race\",   poverty ~ \"Poverty\",\n                rurality ~ \"Rurality\", married ~ \"Married\", yeardx_cat ~ \"Year of diagnosis\",\n                stage ~ \"Stage\", surgcat ~ \"Surgery\", chemo ~ \"Chemotherapy\",\n                radiation ~ \"Radiation\", state~ \"State\", \n                grade ~ \"Grade\", pvgroup ~ \"Gene group\")\ngtsummary::tbl_regression(m_fixed,exponentiate=TRUE,label=my_labels)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR1\n95% CI1\np-value\n\n\n\n\nAge (in decades)\n1.16\n1.10, 1.23\n&lt;0.001\n\n\nRace\n\n\n\n\n\n\n\n\n    NH White\n—\n—\n\n\n\n\n    Asian\n1.13\n0.87, 1.46\n0.4\n\n\n    Black\n1.09\n0.86, 1.40\n0.5\n\n\n    Hispanic\n1.26\n1.03, 1.53\n0.022\n\n\n    Other\n1.41\n0.52, 3.81\n0.5\n\n\nSex\n\n\n\n\n\n\n\n\n    female\n—\n—\n\n\n\n\n    male\n1.10\n0.95, 1.27\n0.2\n\n\nPoverty\n\n\n\n\n\n\n\n\n    &lt;10% poverty\n—\n—\n\n\n\n\n    10%-19% poverty\n0.97\n0.80, 1.19\n0.8\n\n\n    20%+ poverty\n1.28\n0.99, 1.67\n0.061\n\n\nRurality\n\n\n\n\n\n\n\n\n    rural\n—\n—\n\n\n\n\n    urban\n0.84\n0.64, 1.11\n0.2\n\n\nMarried\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.91\n0.78, 1.05\n0.2\n\n\nYear of diagnosis\n\n\n\n\n\n\n\n\n    2013\n—\n—\n\n\n\n\n    2014\n0.89\n0.67, 1.20\n0.5\n\n\n    2015\n0.84\n0.62, 1.12\n0.2\n\n\n    2016\n0.62\n0.47, 0.83\n0.001\n\n\n    2017\n0.63\n0.47, 0.84\n0.002\n\n\n    2018\n0.60\n0.44, 0.81\n&lt;0.001\n\n\n    2019\n0.33\n0.23, 0.46\n&lt;0.001\n\n\nStage\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    0\n1.58\n0.63, 3.94\n0.3\n\n\n    1\n0.40\n0.25, 0.65\n&lt;0.001\n\n\n    3\n1.96\n1.45, 2.64\n&lt;0.001\n\n\n    4\n11.1\n8.28, 15.0\n&lt;0.001\n\n\nSurgery\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.53\n0.45, 0.64\n&lt;0.001\n\n\nChemotherapy\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.16\n0.88, 1.53\n0.3\n\n\nRadiation\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n1.06\n0.82, 1.37\n0.7\n\n\nState\n\n\n\n\n\n\n\n\n    CA\n—\n—\n\n\n\n\n    GA\n1.43\n1.18, 1.73\n&lt;0.001\n\n\nColorectal type\n\n\n\n\n\n\n\n\n    colon\n—\n—\n\n\n\n\n    rectal\n0.84\n0.68, 1.03\n0.10\n\n\nGrade\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    1\n0.85\n0.64, 1.15\n0.3\n\n\n    3\n1.88\n1.59, 2.21\n&lt;0.001\n\n\n    4\n1.39\n0.92, 2.08\n0.12\n\n\nGene group\n\n\n\n\n\n\n\n\n    Negative\n—\n—\n\n\n\n\n    ATM\n1.33\n0.63, 2.81\n0.5\n\n\n    BRCA 1/2\n1.56\n1.00, 2.44\n0.048\n\n\n    CHEK2\n0.99\n0.49, 2.01\n&gt;0.9\n\n\n    Lynch Syndrome\n0.58\n0.43, 0.80\n&lt;0.001\n\n\n    Other PV\n0.79\n0.55, 1.13\n0.2\n\n\n    PALB2\n1.47\n0.47, 4.62\n0.5\n\n\n    VUS only\n0.85\n0.71, 1.03\n0.10\n\n\n\n1 HR = Hazard Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nNote the decreasing hazard ratio with year of diagnosis that is a product of the spread of genetic testing to lower clinical risk groups as discussed as part of the variable selection rationale in (model-strat?) above.\n\n\n\n\n\nTests of heterogeneity\n\n\ncode\nfvar&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$fr_var),scientific=FALSE)\nca&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$ca_test),scientific=FALSE)\nlrt&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$loglik),scientific=FALSE)\n\np11&lt;-table_fig(fvar,tbl_title=\"Variance\",.9)\np12&lt;-table_fig(ca,tbl_title=\"Commenges-Andersen test\",1)\np13&lt;-table_fig(lrt,tbl_title=\"Likelihood ratio test\",.8)\ncowplot::plot_grid(p11,p12,p13,nrow=1)"
  },
  {
    "objectID": "final_round.html#pancreas",
    "href": "final_round.html#pancreas",
    "title": "Main Analyses",
    "section": "Pancreas",
    "text": "Pancreas\n\n\n\n\n\n\nSample description and missing data (click to view)\n\n\n\n\n\n\n\ncode\ncovar5&lt;-c(\"agedec\",\"race\",\"sex\",\"poverty\",\"rurality\",\"married\",\"yeardx_cat\",\"stage\",\"surgcat\",\"chemo\",\"radiation\",\"state\",\"pvgroup\")  #pancreas\ncan_type=5  # use this code for cancer_types 2,3,5\ncovar&lt;-eval(as.name(paste0(\"covar\",can_type,sep=\"\")))\nmort&lt;-get_data(cancer_type=can_type)\n\nmy_labels&lt;-list(agedec ~ \"Age (in decades from mean age)\", race ~ \"Race\", sex ~ \"Sex\",\n                poverty ~ \"Poverty\", rurality ~ \"Rurality\", married ~ \"Married\", \n                yeardx_cat ~ \"Year of diagnosis\", stage ~ \"Stage\", \n                surgcat ~ \"Surgery (Yes=1)\", chemo ~ \"Chemotherapy (Yes=1)\", \n                radiation ~ \"Radiation (Yes=1)\", state~ \"State\", \n                pvgroup ~ \"Gene group\")\ngtsummary::tbl_summary(mort,label=my_labels, missing_text=\"missing\",include=covar) |&gt;\n    gtsummary::modify_caption(\"Table 1. Covariates - Pancreas\")  |&gt;\n    gtsummary::modify_footnote(label = \"Omitted category listed first for categorical variables\" )\n\n\n\n\n\n\nTable 1. Covariates - Pancreas\n\n\n\n\n\n\nCharacteristic1\nN = 1,8612\n\n\n\n\nAge (in decades from mean age)\n0.19 (-0.71, 0.89)\n\n\nRace\n\n\n\n\n    NH White\n1,224 (66%)\n\n\n    Asian\n227 (12%)\n\n\n    Black\n139 (7.5%)\n\n\n    Hispanic\n261 (14%)\n\n\n    Other\n10 (0.5%)\n\n\nSex\n\n\n\n\n    female\n1,004 (54%)\n\n\n    male\n857 (46%)\n\n\nPoverty\n\n\n\n\n    &lt;10% poverty\n1,371 (74%)\n\n\n    10%-19% poverty\n343 (18%)\n\n\n    20%+ poverty\n147 (7.9%)\n\n\nRurality\n\n\n\n\n    rural\n130 (7.0%)\n\n\n    urban\n1,731 (93%)\n\n\nMarried\n1,268 (68%)\n\n\nYear of diagnosis\n\n\n\n\n    2013\n50 (2.7%)\n\n\n    2014\n65 (3.5%)\n\n\n    2015\n98 (5.3%)\n\n\n    2016\n172 (9.2%)\n\n\n    2017\n200 (11%)\n\n\n    2018\n395 (21%)\n\n\n    2019\n881 (47%)\n\n\nStage\n\n\n\n\n    2\n382 (22%)\n\n\n    0\n3 (0.2%)\n\n\n    1\n288 (16%)\n\n\n    3\n320 (18%)\n\n\n    4\n771 (44%)\n\n\n    missing\n97\n\n\nSurgery (Yes=1)\n507 (27%)\n\n\nChemotherapy (Yes=1)\n1,625 (87%)\n\n\nRadiation (Yes=1)\n177 (9.5%)\n\n\nState\n\n\n\n\n    CA\n1,518 (82%)\n\n\n    GA\n343 (18%)\n\n\nGene group\n\n\n\n\n    Negative\n1,032 (55%)\n\n\n    ATM\n49 (2.6%)\n\n\n    BRCA 1/2\n103 (5.5%)\n\n\n    CHEK2\n23 (1.2%)\n\n\n    Lynch Syndrome\n15 (0.8%)\n\n\n    Other PV\n152 (8.2%)\n\n\n    PALB2\n15 (0.8%)\n\n\n    VUS only\n472 (25%)\n\n\n\n1 Omitted category listed first for categorical variables\n\n\n2 Median (Q1, Q3); n (%)\n\n\n\n\n\n\n\n\n\n\n\nFor pancreatic cancer the models stage 0 and 1 were collapsed given small sample sizes in those with Stage 0.\n\nModel output\n\nRandom effects for gene group (as shown in figure 1)\n\n\ncode\nmort$stage&lt;-forcats::fct_collapse(mort$stage, \"0-1\" = c(\"0\",\"1\"))\n# random effects\nif(params$frailty==\"on\") {\n    m_emfrail&lt;-get_random(mort,can_type,covar)\n}\n\n# fixed effects\nm_fixed&lt;-get_fixed(mort,covar)\n\n# graph\n## process fixed effects\nfe&lt;-process_fixed(m_fixed)\n## process random effects\nfile_name=paste(\"data/\",\"m_emfrail\",can_type,\".Rdata\",sep=\"\")\nload(file_name)\nlogz&lt;-process_random(m_emfrail)\n## combine and graph\ndatt&lt;-combine_effects(fe,logz)\np5&lt;-graph_effects_vert(datt)\np5 &lt;- forestploter::edit_plot(p5,\n               col = 1,\n               row = c(1:3,7),\n               gp = gpar(fontface = \"italic\"))\np5 &lt;- forestploter::insert_text(p5, text = \"Pancreatic Cancer\",\n              part = \"header\",\n              col = 1:3,\n              gp = gpar(fontface = \"bold\"))\nmy_pval&lt;-1/2*pchisq(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],1, lower.tail=FALSE)\nmy_chi&lt;-paste0(\"Likelihood ratio test for heterogeneity \\U{03A7}\\U{00B2} = \",round(frailtyEM:::summary.emfrail(m_emfrail)$loglik[[3]],2),\", p\",pvalr(my_pval))\np5 &lt;- forestploter::insert_text(p5, text = my_chi,\n   part = \"header\", just = \"right\",\n   col = 3, gp = gpar(fontsize=10) )\n\nggsave(p5,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"svg\",sep=\"\"))\nggsave(p5,filename=paste(\"img/\",\"m_emfrail\",can_type,\".\",\"pdf\",sep=\"\"),device=cairo_pdf)\n\n\n\n\n  \n\n\n\n  \n    \n  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGene\nATM\n \nBRCA 1/2\nCI\nCHEK2\nLynch Syndrome\nNegative\nOther PV\nPALB2\nVUS only\n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n                                                                     \n1.2 (0.8, 1.7)\n1.0 (0.8, 1.2)\n0.9 (0.7, 1.2)\n0.8 (0.7, 1.0)\n0.8 (0.5, 1.4)\n0.9 (0.7, 1.2)\n0.4 (0.2, 1.0)\n0.9 (0.6, 1.1)\n1.3 (1.1, 1.7)\n1.1 (1.0, 1.2)\n1.5 (1.1, 2.0)\n1.2 (1.0, 1.4)\n1.4 (0.7, 2.6)\n1.0 (0.8, 1.3)\n1.3 (1.1, 1.7)\n1.1 (1.0, 1.2)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0.25\n0.5\n2\n4\nLower risk\n\n\nHigher risk\n\n\nPancreatic Cancer\nLikelihood ratio test for heterogeneity Χ² = 2.05, p= 0.076\n\n\n\n\n\n\n\n\nFixed effects model (click to view)\n\n\n\n\n\n\n\ncode\nmy_labels&lt;-list(agedec ~ \"Age (in decades)\", race ~ \"Race\",   poverty ~ \"Poverty\",\n                rurality ~ \"Rurality\", married ~ \"Married\", yeardx_cat ~ \"Year of diagnosis\",\n                stage ~ \"Stage\", surgcat ~ \"Surgery\", chemo ~ \"Chemotherapy\",\n                radiation ~ \"Radiation\", state~ \"State\", \n                pvgroup ~ \"Gene group\")\ngtsummary::tbl_regression(m_fixed,exponentiate=TRUE,label=my_labels)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\nHR1\n95% CI1\np-value\n\n\n\n\nAge (in decades)\n1.13\n1.07, 1.20\n&lt;0.001\n\n\nRace\n\n\n\n\n\n\n\n\n    NH White\n—\n—\n\n\n\n\n    Asian\n1.08\n0.88, 1.33\n0.5\n\n\n    Black\n0.95\n0.75, 1.21\n0.7\n\n\n    Hispanic\n1.19\n0.98, 1.45\n0.076\n\n\n    Other\n1.55\n0.73, 3.31\n0.3\n\n\nSex\n\n\n\n\n\n\n\n\n    female\n—\n—\n\n\n\n\n    male\n1.06\n0.93, 1.20\n0.4\n\n\nPoverty\n\n\n\n\n\n\n\n\n    &lt;10% poverty\n—\n—\n\n\n\n\n    10%-19% poverty\n1.16\n0.98, 1.38\n0.091\n\n\n    20%+ poverty\n1.38\n1.08, 1.76\n0.009\n\n\nRurality\n\n\n\n\n\n\n\n\n    rural\n—\n—\n\n\n\n\n    urban\n1.14\n0.89, 1.46\n0.3\n\n\nMarried\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.89\n0.78, 1.03\n0.11\n\n\nYear of diagnosis\n\n\n\n\n\n\n\n\n    2013\n—\n—\n\n\n\n\n    2014\n0.82\n0.54, 1.26\n0.4\n\n\n    2015\n0.69\n0.46, 1.03\n0.066\n\n\n    2016\n0.67\n0.46, 0.97\n0.035\n\n\n    2017\n0.61\n0.42, 0.89\n0.010\n\n\n    2018\n0.58\n0.41, 0.84\n0.004\n\n\n    2019\n0.44\n0.31, 0.63\n&lt;0.001\n\n\nStage\n\n\n\n\n\n\n\n\n    2\n—\n—\n\n\n\n\n    0-1\n0.86\n0.67, 1.10\n0.2\n\n\n    3\n1.05\n0.85, 1.31\n0.6\n\n\n    4\n1.52\n1.25, 1.84\n&lt;0.001\n\n\nSurgery\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.43\n0.35, 0.52\n&lt;0.001\n\n\nChemotherapy\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n2.04\n1.57, 2.64\n&lt;0.001\n\n\nRadiation\n\n\n\n\n\n\n\n\n    No\n—\n—\n\n\n\n\n    Yes\n0.87\n0.70, 1.09\n0.2\n\n\nState\n\n\n\n\n\n\n\n\n    CA\n—\n—\n\n\n\n\n    GA\n1.67\n1.41, 1.96\n&lt;0.001\n\n\nGene group\n\n\n\n\n\n\n\n\n    Negative\n—\n—\n\n\n\n\n    ATM\n0.87\n0.58, 1.29\n0.5\n\n\n    BRCA 1/2\n0.68\n0.52, 0.90\n0.006\n\n\n    CHEK2\n0.61\n0.33, 1.15\n0.13\n\n\n    Lynch Syndrome\n0.32\n0.12, 0.85\n0.023\n\n\n    Other PV\n1.12\n0.89, 1.41\n0.3\n\n\n    PALB2\n1.03\n0.51, 2.09\n&gt;0.9\n\n\n    VUS only\n1.00\n0.85, 1.16\n&gt;0.9\n\n\n\n1 HR = Hazard Ratio, CI = Confidence Interval\n\n\n\n\n\n\n\n\nNote the decreasing hazard ratio with year of diagnosis that is a product of the spread of genetic testing to lower clinical risk groups as discussed as part of the variable selection rationale in (model-strat?) above.\n\n\n\n\n\nTests of heterogeneity\n\n\ncode\nfvar&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$fr_var),scientific=FALSE)\nca&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$ca_test),scientific=FALSE)\nlrt&lt;-format(as.list(frailtyEM:::summary.emfrail(m_emfrail)$loglik),scientific=FALSE)\n\np11&lt;-table_fig(fvar,tbl_title=\"Variance\",.9)\np12&lt;-table_fig(ca,tbl_title=\"Commenges-Andersen test\",1)\np13&lt;-table_fig(lrt,tbl_title=\"Likelihood ratio test\",.8)\ncowplot::plot_grid(p11,p12,p13,nrow=1)"
  },
  {
    "objectID": "final_round.html#arrange-plots",
    "href": "final_round.html#arrange-plots",
    "title": "Main Analyses",
    "section": "Arrange plots",
    "text": "Arrange plots\nExtract legend from dummy plot\n\n\ncode\np_leg&lt;-ggplot(\n  datt, aes(x = ord, y = estimate, group = as.factor(type), \n            color = as.factor(type)) ) + \n  geom_point() + geom_line()  +\n  scale_color_manual(values = c(\"#377eb8\", \"#4daf4a\"), name=\"Estimates\", \n                     labels=c(\"Fixed\", \"Random\"),\n                     guide = guide_legend(override.aes = list(size = 3,shape=22,\n                                                              fill=c(\"#377eb8\", \"#4daf4a\")) )\n                     )  +\n  theme(legend.key = element_rect(fill = \"white\"), \n        legend.text=element_text(size=12),legend.title=element_text(size=12))\n\nextract_legend&lt;-function(myggplot){\n    tmp &lt;- ggplot_gtable(ggplot_build(myggplot))\n    leg &lt;- which(sapply(tmp$grobs, function(x) x$name) == \"guide-box\")\n    legend &lt;- tmp$grobs[[leg]]\n    return(legend)\n}\nmy_legend&lt;-extract_legend(p_leg)\n#cowplot::plot_grid(p1,my_legend)\n\n\nPlot 5 figures and legend together for Figure 1.\n\n\ncode\np_final&lt;-cowplot::plot_grid(p1,p2,p3,p4,p5,my_legend, ncol=2,\n                            align=\"AUTO\")\nsave(p_final,file=\"data/p_final.Rdata\")\nggplot2::ggsave(p_final, \n                filename = \"final_plot.pdf\", \n                path = \"img/\", \n                units = \"in\", width =11.6, height = 15, \n                dpi = 300, bg = \"white\",device=cairo_pdf)"
  },
  {
    "objectID": "projects.html#project-2",
    "href": "projects.html#project-2",
    "title": "Projects",
    "section": "Project 2",
    "text": "Project 2"
  },
  {
    "objectID": "projects.html#project-3",
    "href": "projects.html#project-3",
    "title": "Projects",
    "section": "Project 3",
    "text": "Project 3"
  },
  {
    "objectID": "secondary.html",
    "href": "secondary.html",
    "title": "Additional Analyses",
    "section": "",
    "text": "Additional analyses were undertaken to see if estimates changed after accounting for,"
  },
  {
    "objectID": "secondary.html#missing-data-competing-risks-and-time-varying-diagnostic-changes",
    "href": "secondary.html#missing-data-competing-risks-and-time-varying-diagnostic-changes",
    "title": "Additional Analyses",
    "section": "Missing data, competing risks and time-varying diagnostic changes",
    "text": "Missing data, competing risks and time-varying diagnostic changes\nHazard ratios and 95% confidence intervals are shown from a proportional hazards survival model of mortality. Data includes all tested patients diagnosed with the specified cancers diagnosed in calendar years 2013-2019. Followup is through 1/1/2022. Followup time (time zero) begins at 6 months after diagnosis. Patients tested after 6 months post-diagnosis are not included in the models. Only treatments occurring before the 6 month post diagnosis date are included in the covariates. Data was missing for stage (4.5%) and grade (5.8%) which was imputed using multiple imputation methods. Five imputed sets were created, and model results were combined using Rubin’s procedures *.\nCancer specific deaths are modeled, and deaths from other causes are treated as competing risks, using a competing risk model as per Fine and Gray **. To reflect potential Covid related underreporting, a time-varying covariate is included in all models, indicating time after 1/1/2020.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBreast, Triple Negative\n\n\nBreast, HER2+\n\n\nBreast, ER/PR+, HER2-\n\n\nColorectal\n\n\nPancreatic\n\n\n\n\n\n\n\nHR\nLower\nUpper\nHR\nLower\nUpper\nHR\nLower\nUpper\nHR\nLower\nUpper\nHR\nLower\nUpper\n\n\nGenetic testing result\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNegative (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nATM\n3.84\n1.71\n8.62\n0.67\n0.23\n1.96\n0.73\n0.40\n1.33\n1.39\n0.81\n2.40\n1.01\n0.62\n1.66\n\n\nCHEK2\n0.27\n0.06\n1.22\n0.29\n0.08\n1.07\n0.86\n0.55\n1.34\n1.05\n0.61\n1.80\n0.28\n0.09\n0.88\n\n\nPALB2\n0.74\n0.43\n1.28\n0.95\n0.22\n4.08\n1.26\n0.79\n1.99\n1.41\n0.93\n2.16\n1.56\n0.88\n2.77\n\n\nBRCA 1/2\n0.66\n0.54\n0.81\n1.18\n0.74\n1.88\n1.23\n1.03\n1.48\n1.60\n1.05\n2.42\n0.70\n0.52\n0.95\n\n\nLynch Syndrome\n1.95\n0.92\n4.14\n0.00\n0.00\n0.00\n1.96\n1.02\n3.77\n0.63\n0.45\n0.88\n0.61\n0.19\n1.97\n\n\nOther PV\n0.96\n0.68\n1.36\n0.74\n0.38\n1.41\n1.09\n0.78\n1.51\n0.86\n0.63\n1.17\n1.14\n0.84\n1.56\n\n\nVUS only\n1.01\n0.86\n1.18\n0.89\n0.69\n1.14\n0.91\n0.79\n1.06\n0.86\n0.72\n1.04\n1.00\n0.81\n1.22\n\n\nMale (vs. Female)\n\n\n\n\n\n\n\n\n\n1.10\n0.95\n1.26\n1.02\n0.87\n1.20\n\n\nRace and Ethnicity\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNon-Hispanic White (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBlack\n1.11\n0.95\n1.29\n1.43\n1.10\n1.87\n1.27\n1.09\n1.49\n1.03\n0.81\n1.29\n1.12\n0.81\n1.55\n\n\nAsian\n0.69\n0.54\n0.88\n1.07\n0.78\n1.46\n0.91\n0.76\n1.09\n1.07\n0.84\n1.37\n1.02\n0.78\n1.33\n\n\nHispanic\n1.05\n0.90\n1.23\n1.27\n0.99\n1.64\n1.08\n0.93\n1.25\n1.16\n0.97\n1.41\n1.10\n0.85\n1.43\n\n\nOther\n0.39\n0.16\n0.94\n0.68\n0.17\n2.68\n0.83\n0.43\n1.62\n1.15\n0.37\n3.61\n1.06\n0.46\n2.46\n\n\nAge at Diagnosis (decades)\n0.99\n0.94\n1.05\n1.10\n1.01\n1.20\n1.22\n1.17\n1.28\n1.14\n1.07\n1.20\n1.13\n1.05\n1.22\n\n\nPoverty level\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLow (poverty &lt;10%) (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMedium (poverty 10%-19%)\n0.92\n0.78\n1.08\n1.00\n0.77\n1.30\n1.19\n1.03\n1.36\n0.99\n0.81\n1.19\n1.17\n0.92\n1.47\n\n\nHigh (poverty &gt; 20%)\n1.11\n0.92\n1.35\n1.70\n1.25\n2.32\n1.50\n1.25\n1.79\n1.14\n0.88\n1.48\n1.17\n0.84\n1.65\n\n\nRural (vs Urban)\n1.11\n0.90\n1.37\n0.89\n0.59\n1.33\n0.98\n0.80\n1.20\n1.09\n0.82\n1.44\n0.97\n0.69\n1.36\n\n\nMarried (vs Not Married)\n0.97\n0.87\n1.10\n0.82\n0.68\n1.00\n0.80\n0.72\n0.88\n0.93\n0.81\n1.07\n0.91\n0.76\n1.09\n\n\nYear of Diagnosis\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2013 (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2014\n1.15\n0.94\n1.39\n0.99\n0.74\n1.31\n0.83\n0.71\n0.98\n0.86\n0.65\n1.14\n0.84\n0.57\n1.24\n\n\n2015\n1.11\n0.92\n1.35\n0.81\n0.60\n1.11\n0.84\n0.72\n0.99\n0.89\n0.68\n1.16\n0.70\n0.48\n1.02\n\n\n2016\n0.88\n0.71\n1.08\n0.89\n0.64\n1.25\n0.77\n0.64\n0.93\n0.63\n0.48\n0.82\n0.65\n0.45\n0.93\n\n\n2017\n0.86\n0.69\n1.07\n0.86\n0.58\n1.28\n0.63\n0.51\n0.78\n0.62\n0.47\n0.82\n0.61\n0.43\n0.87\n\n\n2018\n0.61\n0.47\n0.79\n0.73\n0.42\n1.26\n0.63\n0.49\n0.83\n0.56\n0.41\n0.78\n0.41\n0.27\n0.64\n\n\n2019\n0.47\n0.34\n0.66\n0.73\n0.38\n1.41\n0.55\n0.40\n0.76\n0.28\n0.19\n0.43\n0.32\n0.19\n0.53\n\n\nStage\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n0.27\n0.16\n0.43\n0.36\n0.11\n1.15\n0.29\n0.20\n0.40\n1.84\n0.78\n4.30\n0.00\n0.00\n0.00\n\n\n1 (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n2.59\n2.10\n3.19\n2.90\n2.01\n4.17\n1.85\n1.58\n2.18\n2.39\n1.50\n3.80\n1.41\n1.02\n1.93\n\n\n3\n9.28\n7.49\n11.49\n8.80\n6.04\n12.80\n5.28\n4.42\n6.31\n4.63\n2.83\n7.56\n1.54\n1.11\n2.15\n\n\n4\n26.45\n20.61\n33.96\n24.45\n16.57\n36.07\n16.20\n13.28\n19.75\n24.18\n14.79\n39.51\n2.08\n1.50\n2.88\n\n\nGrade\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n1 (ref)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n2\n1.25\n0.73\n2.11\n0.93\n0.53\n1.64\n1.58\n1.32\n1.90\n1.10\n0.88\n1.39\n\n\n\n\n\n3\n1.18\n0.70\n1.98\n1.30\n0.75\n2.28\n3.34\n2.77\n4.03\n1.89\n1.47\n2.43\n\n\n\n\n\n4\n1.02\n0.38\n2.72\n0.67\n0.07\n6.11\n1.64\n0.48\n5.62\n1.53\n1.01\n2.32\n\n\n\n\n\nColon (vs. Rectum)\n\n\n\n\n\n\n\n\n\n1.13\n0.94\n1.36\n\n\n\n\n\nSurgery (Breast)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLumpectomy\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUnilateral mastectomy\n1.77\n1.47\n2.13\n0.58\n0.42\n0.80\n1.33\n1.13\n1.57\n\n\n\n\n\n\n\n\nBilateral mastectomy\n1.25\n1.03\n1.53\n1.65\n1.21\n2.25\n1.18\n0.99\n1.41\n\n\n\n\n\n\n\n\nOther\n1.52\n1.15\n2.01\n1.62\n1.16\n2.25\n0.99\n0.76\n1.28\n\n\n\n\n\n\n\n\nNo surgery\n1.69\n1.43\n2.00\n1.37\n0.83\n2.26\n2.18\n1.84\n2.58\n\n\n\n\n\n\n\n\nSurgery (vs. None) (Non-Breast)\n\n\n\n\n\n\n\n\n\n0.55\n0.46\n0.66\n0.53\n0.43\n0.65\n\n\nChemotherapy (vs None)\n0.89\n0.73\n1.08\n1.48\n1.11\n1.97\n1.22\n1.07\n1.40\n1.23\n0.93\n1.63\n2.19\n1.57\n3.05\n\n\nRadiation Therapy (vs None)\n1.47\n1.21\n1.79\n0.70\n0.55\n0.88\n0.92\n0.79\n1.07\n1.02\n0.81\n1.30\n0.83\n0.63\n1.10\n\n\nHER2-Directed Therapy (vs None)\n0.96\n0.71\n1.30\n0.63\n0.49\n0.80\n0.98\n0.75\n1.26\n\n\n\n\n\n\n\n\nState: CA (vs. GA)\n0.78\n0.67\n0.91\n0.78\n0.57\n1.07\n0.62\n0.55\n0.71\n0.70\n0.58\n0.83\n0.67\n0.55\n0.82\n\n\n\n* Rubin, D.B. (1987), Multiple Imputation for Nonresponse in Surveys, New York: John Wiley & Sons, Inc.\n** Fine, Jason P., and Robert J. Gray. “A proportional hazards model for the subdistribution of a competing risk.” Journal of the American Statistical Association 94.446 (1999): 496-509."
  },
  {
    "objectID": "index.html#christine-m.-veenstra-md-mshp-paul-abrahamse-ma2-ann-s.-hamilton-phd-lihua-liu-phd3-steven-j.-katz-md-mph-timothy-p.-hofer-md-msc-kevin-c.-ward-phd4-and-allison-w.-kurian-md-msc",
    "href": "index.html#christine-m.-veenstra-md-mshp-paul-abrahamse-ma2-ann-s.-hamilton-phd-lihua-liu-phd3-steven-j.-katz-md-mph-timothy-p.-hofer-md-msc-kevin-c.-ward-phd4-and-allison-w.-kurian-md-msc",
    "title": "Supplemental materials (Version 1.0) Breast, Colorectal, and Pancreatic Cancer Mortality With Pathogenic Variants in ATM, CHEK2, or PALB2",
    "section": "",
    "text": "Supplemental information on data and complete model outputs as well as all R and Stata code used for the analyses presented in the paper published 2025 in the Journal of Clinical Oncology DOI https://doi.org/10.1200/JCO-24-02442"
  }
]